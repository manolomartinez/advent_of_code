ToNat â‡ {(10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½-âŸœ'0')ğ•©}
Split â‡ {ğ•¨((âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢)ğ•©}
diskmap â† ToNat â€¢file.Lines "./input.txt"
numbers â† (Â¬2|â†•âˆ˜â‰ )âŠ¸/diskmap
spaces â† (2|â†•âˆ˜â‰ )âŠ¸/diskmap
ids â† â†•â‰ numbers
# I'll make a list with âŸ¨numbers, spaces, idsâŸ©

NumberHigher â† {
  numbers â† âŠ‘ğ•©
  spaces â† 1âŠ‘ğ•©
  ids â† 2âŠ‘ğ•©
  fns â† âŠ‘âŠ‘/â—‹â¥ŠâŸœ(â†•â‰¢) spaces > 0
  space â† fnsâŠ‘spaces
  numbers ((-space)âŠ¸+)âŒ¾(Â¯1âŠ¸âŠ‘) â†©
  numbers (fns+1)âŠ¸(â†“{ğ•©âˆ¾spaceâˆ¾ğ•¨}â†‘) â†© 
  spaces 0âŒ¾(fnsâŠ¸âŠ‘) â†©
  spaces fnsâŠ¸(â†“{ğ•©âˆ¾0âˆ¾ğ•¨}â†‘) â†© 
  ids â†© (fns+1)âŠ¸(â†“{ğ•©âˆ¾(Â¯1âŠ‘ids)âˆ¾ğ•¨}â†‘) ids
  âŸ¨numbers, spaces, idsâŸ©
}

SpaceHigher â† {
  numbers â† âŠ‘ğ•©
  spaces â† 1âŠ‘ğ•©
  ids â† 2âŠ‘ğ•©
  fns â† âŠ‘âŠ‘/â—‹â¥ŠâŸœ(â†•â‰¢) spaces > 0
  space â† fnsâŠ‘spaces
  number â† Â¯1âŠ‘numbers
  spaces (space-number)âŒ¾(fnsâŠ¸âŠ‘) â†©
  spaces fnsâŠ¸(â†“{ğ•©âˆ¾0âˆ¾ğ•¨}â†‘) â†© 
  numbers (fns+1)âŠ¸(â†“{ğ•©âˆ¾numberâˆ¾ğ•¨}â†‘) â†© 
  numbers Â¯1âŠ¸â†“ â†©
  ids Â¯1âŠ¸â†“ â†© (fns+1)âŠ¸(â†“{ğ•©âˆ¾(Â¯1âŠ‘ids)âˆ¾ğ•¨}â†‘) ids
  âŸ¨numbers, spaces, idsâŸ©
}

OneMove â† {
  numbers â† âŠ‘ğ•©
  spaces â† 1âŠ‘ğ•©
  ids â† 2âŠ‘ğ•©
  #first nonzero space
  fns â† âŠ‘âŠ‘/â—‹â¥ŠâŸœ(â†•â‰¢) spaces > 0
  ((fnsâŠ‘spaces) â‰¥ (Â¯1âŠ¸+âˆ˜â‰¢)âŠ¸âŠ‘ numbers)â—¶NumberHigherâ€¿SpaceHigher ğ•©
}

# Solution to part 1
+Â´ (â†•â‰ )âŠ¸Ã— (âŠ‘/2âŠ¸âŠ‘) OneMove â€¢_while_ {âˆ¨Â´((â‰ 2âŠ¸âŠ‘)â†‘1âŠ¸âŠ‘)ğ•©} numbersâ€¿spacesâ€¿ids 

# Part 2 doesn't work. I resorted to doing it in python

OneMove2 â† {
  numbersâ€¿spacesâ€¿idsâ€¿current_id â† ğ•©
  #â€¢Show current_id
  #spaces â† 1âŠ‘ğ•©
  #â€¢Show spaces
  #ids â† 2âŠ‘ğ•©,
  #current_id â† 3âŠ‘ğ•© 
  #first nonzero space
  size â† numbersâŠ¸(âŠ‘Ëœ) id_pos â† âŠ‘âŠ‘/â—‹â¥ŠâŸœ(â†•â‰¢) current_id = ids
  â€¢Show "size"
  â€¢Show size
  â€¢Show "id_pos"
  â€¢Show id_pos
  slots â† (id_pos)âŠ¸>âŠ¸/ â¥Š> /â—‹â¥ŠâŸœ(â†•â‰¢) spaces â‰¥ size
  #â€¢Show slots
  slot â† (âŠ‘âŠ‘)âŠÂ¯1 slots
  #â€¢Show "slot"
  â€¢Show slot
  
  (Â¯1â‰ slot)â—¶{numbersâ€¿spacesâ€¿idsâ€¿(current_id-1)}â€¿{
    âŸ¨(slot+1)âŠ¸(â†“{ğ•©âˆ¾sizeâˆ¾ğ•¨}â†‘) id_posâŠ¸(â†‘âˆ¾1âŠ¸+âŠ¸â†“) numbers, 
     slotâŠ¸(â†‘{ğ•¨âˆ¾0âˆ¾ğ•©}â†“) ((slotâŠ‘spaces)-size)âŒ¾((slot)âŠ¸âŠ‘) (id_pos-1)âŠ¸(â†‘âˆ¾1âŠ¸+âŠ¸â†“) (size+(id_posâŠ‘spaces)+((id_pos-1)âŠ‘spaces))âŒ¾((id_pos)âŠ¸âŠ‘) spaces
    (slot+1)âŠ¸(â†“{ğ•©âˆ¾current_idâˆ¾ğ•¨}â†‘) id_posâŠ¸(â†‘âˆ¾1âŠ¸+âŠ¸â†“) ids, 
    current_id-1âŸ©} ğ•©
}


â‰ numbers

numbersfâ€¿spacefâ€¿idsfâ€¿pos â† OneMove2 â€¢_while_{0â‰¤3âŠ‘ğ•©}numbersâ€¿(spacesâˆ¾0)â€¿idsâ€¿(Â¯1+â‰ numbers)
+Â´ +Â´Â¨ idsf Ã— (+`0Â»spacef) + {(ğ•©âŠ¸/â†•â‰ ğ•©)âŠ¸âŠ”â†•+Â´ğ•©} numbersf
{(ğ•©âŠ¸/â†•â‰ ğ•©)âŠ¸âŠ”â†•+Â´ğ•©} numbersf

