a â† â€¢Import "../../../Project Euler/aux.bqn"
m â† â€¢Import "/home/manolo/Software/BQN_cosas/bqn-libs/matrix.bqn"
G â† {
# Create the graph, using ğ•© as starting node
# g is the graph as a hashmap, to each node corresponds a list of children, a
# list of parents, a distance, and a list of parents that have already shared
# their message
  aux â† â€¢HashmapÂ´((Â¯1â†“âŠ‘)Â¨â‹ˆ1âŠ¸â†“Â¨)' 'âŠ¸a.SplitÂ¨ â€¢FLines "./input.txt"
  aux.Keys 0
  aux.GetÂ¨ aux.Keys 0
  "out" aux.Set âŸ¨âŸ©
  r â† âŸ¨âŸ© # relevant nodes, we will delete the rest
  {oâ†â·âˆ¾Â´aux.GetÂ¨ ğ•©â‹„râ†©â·râˆ¾oâ‹„o}â€¢_while_(0<â‰ ) â‹ˆğ•© # relevant nodes
  r âŸ¨ğ•©âŸ©âŠ¸âˆ¾â†©
  nâ€¿c â†  âŸ¨r,aux.GetÂ¨râŸ© # nodes, children
  pâ†nâŠ¸{ğ•©/ğ•¨}Â¨<Ë˜â‰c{âˆ¨Â´ğ•©âŠ¸â‰¡Â¨ğ•¨}âŒœn # parents
  gâ†nâ€¢Hashmap(câ‹ˆÂ¨p)âˆ¾Â¨<âŸ¨0,âŸ¨âŸ©âŸ© 
  ğ•© g.Set âŸ¨(âŠ‘g.Get ğ•©),âŸ¨"dummy"âŸ©,1,âŸ¨"dummy"âŸ©âŸ©
  g
}
Add â† { 
  # Add your distance to your children in graph ğ•¨
  gğ•Šn: # graph and node
  n
  câ€¿pâ€¿dâ€¿vâ†g.Get n # distance and children
  {c2â€¿p2â€¿d2â€¿v2â†g.Get ğ•©â‹„ğ•© g.Set (â‹ˆc2)âˆ¾(â‹ˆp2)âˆ¾(d+d2)âˆ¾(â‹ˆâ·v2âˆ¾â‹ˆn)}Â¨c
  n g.Set âŸ¨c,p,d,âŸ¨âŸ©âŸ©
}
Msg â† {
  # A node ğ•© sends its distance to its children in graph ğ•¨, but only if ğ•© has
  # received every distance from its parents alrÃ§eady
  câ€¿pâ€¿dâ€¿v â† ğ•¨.Get ğ•©
  (âˆ§Â´pâˆŠv)â—¶âŸ¨âŠ¢,ğ•¨âŠ¸AddâŸ© ğ•© # Has the node received all message from parents?
  â·c
}
you â† G "you"
youâŠ¸(âˆ¾Â´MsgÂ¨)â€¢_while_(0<â‰ ) â‹ˆ"you"
â€¢Show 2âŠ‘you.Get "out" # part 1
svr â† G "svr"
dac â† G "dac"
fft â† G "fft"
{â·âˆ¾Â´svrâŠ¸MsgÂ¨ğ•©}â€¢_while_(0<â‰ ) â‹ˆ"svr"
{â·âˆ¾Â´dacâŠ¸MsgÂ¨ğ•©}â€¢_while_(0<â‰ ) â‹ˆ"dac"
{â·âˆ¾Â´fftâŠ¸MsgÂ¨ğ•©}â€¢_while_(0<â‰ ) â‹ˆ"fft"
sfâ†2âŠ‘svr.Get "fft"
fdâ†2âŠ‘fft.Get "dac"
doâ†2âŠ‘dac.Get "out"
â€¢Show sfÃ—fdÃ—do # part 2
