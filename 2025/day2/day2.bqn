a â† â€¢Import "../../../Project Euler/aux.bqn"
p â† â€¢Import "/home/manolo/Software/BQN_cosas/bqn-libs/primes.bqn"
ranges â† '-'âŠ¸a.SplitÂ¨ ',' a.Split Â¯2â†“ â€¢file.Chars "./input.txt" 
Odd â† (âŒŠâ‰ âŠ¢)Ã·âŸœ2

FixRange â† {
  ğ•¨ğ•Šğ•©: (OddâŠ‘â‰¢ğ•¨)âˆ§(OddâŠ‘â‰¢ğ•©)? 0â€¿0;
  ğ•¨ğ•Šğ•©: (OddâŠ‘â‰¢ğ•¨)âˆ§(Â¬OddâŠ‘â‰¢ğ•©)? âŸ¨â€¢Repr 10â‹†-âŸœ1âŠ‘â‰¢ğ•©,ğ•©âŸ©;
  ğ•¨ğ•Šğ•©: (Â¬OddâŠ‘â‰¢ğ•¨)âˆ§(OddâŠ‘â‰¢ğ•©)? âŸ¨ğ•¨,â€¢Repr -âŸœ1 10â‹†âŠ‘â‰¢ğ•¨âŸ©;
  âŸ¨ğ•¨,ğ•©âŸ©
}

ranges1 â† FixRangeÂ´Â¨ ranges
FindIDs â† {
  0ğ•Š0: âŸ¨âŸ©;
  start â† a.StrToNat (Ã·âŸœ2âˆ˜âŠ‘â‰¢)âŠ¸â†‘ğ•¨
  end â† a.StrToNat (Ã·âŸœ2âˆ˜âŠ‘â‰¢)âŠ¸â†‘ğ•©
  (â‰¥âŸœ(a.StrToNat ğ•¨))âŠ¸/(â‰¤âŸœ(a.StrToNat ğ•©))âŠ¸/a.StrToNatÂ¨ (âŠ‘â‰¢ğ•©)âŠ¸â¥ŠÂ¨â€¢ReprÂ¨ start + â†•1+end-start
}


â€¢Show +Â´âˆ¾Â´ FindIDsÂ´Â¨ ranges1 # Part 1

FixRange2 â† {
  ğ•¨ğ•Šğ•©: ğ•¨â‰ â—‹(âŠ‘â‰¢)ğ•©? âŸ¨âŸ¨ğ•¨,â€¢Repr -âŸœ1 10â‹†âŠ‘â‰¢ğ•¨âŸ©,âŸ¨â€¢Repr 10â‹†-âŸœ1âŠ‘â‰¢ğ•©,ğ•©âŸ©âŸ©;
  âŸ¨âŸ¨ğ•¨,ğ•©âŸ©âŸ©
}

ranges2 â† âˆ¾Â´ FixRange2Â´Â¨ ranges


FindAux â† {
  nğ•ŠâŸ¨s,eâŸ©:
  start â† a.StrToNat nâ†‘s
  end â† a.StrToNat nâ†‘e
  (â‰¥âŸœ(a.StrToNat s))âŠ¸/(â‰¤âŸœ(a.StrToNat e))âŠ¸/a.StrToNatÂ¨ (âŠ‘â‰¢s)âŠ¸â¥ŠÂ¨â€¢ReprÂ¨ start + â†•1+end-start
}

FindIDs2 â† {
  sğ•Še:
  candidates â† â†•âŠ¸(âŠ£/Ëœ0=|)âŠ‘â‰¢ğ•¨
  {ğ•© FindAux sâ€¿e}Â¨ candidates
}

â€¢Show +Â´â·âˆ¾Â´âˆ¾Â´ FindIDs2Â´Â¨ ranges2 # Part 2
