a â† â€¢Import "../../../Project Euler/aux.bqn"
coords â† a.StrToNatÂ¨Â¨ ','âŠ¸a.SplitÂ¨ â€¢FLines "./input.txt" 
â€¢Show âŒˆÂ´â¥Š(Ã—Â´1+-)âŒœËœcoords # part 1
cc â† ((âˆ§âˆ˜â·âŠ¸âŠâŠ‘Â¨)â‹ˆÂ¨(âˆ§âˆ˜â·âŠ¸âŠ1âŠ¸âŠ‘Â¨))coords # coordinate compression

Fillx â† {
  ğ•Šc:
  xs â† {(âŠ‘âŠ‘ğ•©)âŠ¸â‹ˆÂ¨(âŒŠÂ´â‹ˆâŒˆÂ´)1âŠ¸âŠ‘Â¨ğ•©}Â¨((â·âŠ‘Â¨c)=Â¨<(âŠ‘Â¨c)){ğ•¨âŠ¸/ğ•©}Â¨<c
  âˆ¾Â´{(âŠ‘âŠ‘ğ•©)âŠ¸â‹ˆÂ¨(âŠ‘+(â†•1+1âŠ¸âŠ‘-âŠ‘))1âŠ¸âŠ‘Â¨ğ•©}Â¨xs 
}

Filly â† {
  ğ•Šc:
  ys â† {(âŠ‘1âŠ¸âŠ‘Â¨ğ•©) â‹ˆËœÂ¨(âŒŠÂ´â‹ˆâŒˆÂ´)âŠ‘Â¨ğ•©}Â¨((â·1âŠ¸âŠ‘Â¨c)=Â¨<(1âŠ¸âŠ‘Â¨c)){ğ•¨âŠ¸/ğ•©}Â¨ <c
  âˆ¾Â´{â‹ˆÂ¨âŸœ(1âŠ‘âŠ‘ğ•©)(âŠ‘+(â†•1+1âŠ¸âŠ‘-âŠ‘))âŠ‘Â¨ğ•©}Â¨ys 
}
filled â† (âˆ¨Fillyâˆ˜Fillx) cc
FullSquare â† {
  aâ€¿bğ•Šcâ€¿d:
  maxbdâ€¿minbd â† âˆ¨bâ€¿d
  maxacâ€¿minac â† âˆ¨aâ€¿c
  topâ†maxacâ‹ˆÂ¨minbd + â†•1+maxbd-minbd 
  bottomâ†minacâ‹ˆÂ¨minbd + â†•1+maxbd-minbd 
  rightâ†maxbdâ‹ˆËœÂ¨minac + â†•1+maxac-minac 
  leftâ†minbdâ‹ˆËœÂ¨minac + â†•1+maxac-minac 
  âˆ§Â´(â·âˆ¾Â´ topâ€¿bottomâ€¿rightâ€¿left) âˆŠ filled
}
sortedâ†(â’â¥Š(Ã—Â´1+-)âŒœËœcoords)âŠ‘Â¨<â¥Šâ‹ˆâŒœËœcc
â€¢Show (Ã—Â´1+-)Â´(<coords) âŠ‘ËœÂ¨ccâŠsortedâŠ‘Ëœ1âŠ¸+â€¢_while_{Â¬FullSquareÂ´ ğ•©âŠ‘sorted} 0 # part2
